<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[DX] Building a Slack Bot for Internal Coffee Chats | Ding's Coding Forge</title>
<meta name=keywords content="slack-bot,coffee-chat"><meta name=description content="Developers often work alone, deeply diving into specific techniques. However, as members of a company, we need a space to discuss and brainstorm together. Inspired by the spirit of Ubuntu, I created my own Slack app Slack Bolt Coffee Chat, Coffee Pal"><meta name=author content="dingyu"><link rel=canonical href=https://dingyu.dev/en/posts/coffee-pal/><meta name=google-site-verification content="8XY1hI6NVxQIrN7bQbnX-9TG9HHFw5HOQmlb6vcsFdQ"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.ba0de23ad40e17ca82720b577f8ae6ec11a26fb07407316cff70888e344ad129.css integrity="sha256-ug3iOtQOF8qCcgtXf4rm7BGib7B0BzFs/3CIjjRK0Sk=" rel="preload stylesheet" as=style><link rel=icon href=https://dingyu.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://dingyu.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://dingyu.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://dingyu.dev/apple-touch-icon.png><link rel=mask-icon href=https://dingyu.dev/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=ko href=https://dingyu.dev/posts/coffee-pal/><link rel=alternate hreflang=en href=https://dingyu.dev/en/posts/coffee-pal/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XH8830R9KK"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XH8830R9KK")}</script><meta property="og:url" content="https://dingyu.dev/en/posts/coffee-pal/"><meta property="og:site_name" content="Ding's Coding Forge"><meta property="og:title" content="[DX] Building a Slack Bot for Internal Coffee Chats"><meta property="og:description" content="Developers often work alone, deeply diving into specific techniques. However, as members of a company, we need a space to discuss and brainstorm together. Inspired by the spirit of Ubuntu, I created my own Slack app Slack Bolt Coffee Chat, Coffee Pal"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-10-26T00:00:00+00:00"><meta property="article:modified_time" content="2024-10-26T00:00:00+00:00"><meta property="article:tag" content="Slack-Bot"><meta property="article:tag" content="Coffee-Chat"><meta property="og:image" content="https://dingyu.dev/en/posts/coffee-pal/img/slack.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dingyu.dev/en/posts/coffee-pal/img/slack.png"><meta name=twitter:title content="[DX] Building a Slack Bot for Internal Coffee Chats"><meta name=twitter:description content="Developers often work alone, deeply diving into specific techniques. However, as members of a company, we need a space to discuss and brainstorm together. Inspired by the spirit of Ubuntu, I created my own Slack app Slack Bolt Coffee Chat, Coffee Pal"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://dingyu.dev/en/posts/"},{"@type":"ListItem","position":2,"name":"[DX] Building a Slack Bot for Internal Coffee Chats","item":"https://dingyu.dev/en/posts/coffee-pal/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[DX] Building a Slack Bot for Internal Coffee Chats","name":"[DX] Building a Slack Bot for Internal Coffee Chats","description":"Developers often work alone, deeply diving into specific techniques. However, as members of a company, we need a space to discuss and brainstorm together. Inspired by the spirit of Ubuntu, I created my own Slack app Slack Bolt Coffee Chat, Coffee Pal","keywords":["slack-bot","coffee-chat"],"articleBody":" Source Code: https://github.com/dings-things/coffee_pal\nPurpose Great cultures make great organizations — not just getting things done, but doing them well. Good culture enhances productivity and quality alike.\nI created “CoffeePal” with the idea of helping people stuck on problems or simply wanting a quick small talk boost. The name reflects its purpose: your “coffee pal” during the workday.\nBefore Development The app needed to be easy and fast, seamlessly matching users via our internal Slack tool.\nTo understand the interaction flow, I started with Slack Workflow.\nCreate a Trigger Point\nFor testing, I used a :coffee: emoji reaction to initiate the workflow.\nActivate Workflow\nA message is sent to the reacting user to confirm whether they want to start a coffee chat.\nCollect User Information via Form\nFor personalization, users can optionally input their MBTI and birthday.\nSet Target, Time, and Topic\nDefine the coffee partner, schedule, and discussion topic ahead of time.\nSend Invitation Message to Partner\nUsing the collected data, send an invitation message to the designated partner.\nI used Slack Workflow for the first time and found the UI clean and intuitive.\nHowever, it felt more like a one-way communication than true interaction. So, I decided to expand it into a full Slack app.\nIt felt like being force-fed food I didn’t want…\nRequirements Match users based on pre-saved profile data\nTrigger matching after personal data is submitted Secure compute resources to handle app interactions\nInternal Server Firewall complexity Fast response via socket communication AWS Lambda Free under Free Tier Serverless Can connect with API Gateway Consider future cost after Free Tier Intuitive UI for users at a glance\nUse Slack Block Kit Implementation Using Lambda Create Slack App Set up Lambda Configure Socket Mode Step 1: Create Slack App Go to Slack API and create a new app\nStep 2: Click From scratch Step 3: Choose workspace and name Step 4: Set bot for user interaction Step 5: Enable events Lambda Step 1: Go to Lambda Console Lambda Step 2: Configure function, runtime, architecture Lambda Step 3: Set up API Gateway API Gateway routes HTTP requests to Lambda — essential to integrate Slack Events API with Lambda.\nBut then I asked myself… If we already have a server, why use Lambda? Wouldn’t not using it be wasteful?\nSo I decided to use our spare dev server and implement it via socket mode.\nSocket Mode Configuration What is Socket Mode?\nInstead of sending payloads to public HTTP endpoints, Slack uses a WebSocket connection to deliver app interactions and events.\nAvoiding public endpoints means better security, and you don’t need to subscribe to each event individually.\nStep 1: Generate App-Level Token Grant permissions to a global token for Slack app control inside the server.\nStep 2: Set Token Scope channels:read: Get user info from channels chat:write: Post messages to channels chat:write.public: Write to channels even if not invited groups:read: Access private channel info groups:write: Write in private channels im:write: Send DMs mpim:write: Send group DMs reminders:write: Set reminders Development Slack Bolt A framework for building Slack apps, supporting languages like Node.js, Python, and JavaScript.\nWhile you might consider skipping it… using Bolt avoids a lot of redundant work. Skipping it results in slower development and difficult maintenance.\nWithout Bolt: from slack_sdk import WebClient from slack_sdk.errors import SlackApiError import os, json, base64, urllib.parse def lambda_handler(event, context): bot_token = os.getenv('BOT_KEY') client = WebClient(token=bot_token) if event.get('isBase64Encoded', False): decoded_body = base64.b64decode(event['body']).decode('utf-8') event_body = urllib.parse.unquote_plus(decoded_body)[8:] else: event_body = event['body'] try: event_data = json.loads(event_body) except json.JSONDecodeError: return { 'statusCode': 400, 'body': json.dumps({'message': 'Invalid request'}) } event_type = event_data.get('event', {}).get('type') # handle event_type... With Bolt: app = App(token=settings.SLACK_BOT_TOKEN) @app.event(\"app_home_opened\") def handle_home(event, client: WebClient = None): ... @app.action(\"suggest_coffee_chat_button\") def handle_chat_button(ack, body, client: WebClient = None): ... Bolt simplifies:\nAuth Routing by event/action/view Middleware chaining Block Kit Block Kit is at the heart of Slack app UI design.\nEach visual unit is a “block”. You compose a full view by stacking them.\nHOME_VIEW = { \"type\": \"home\", \"blocks\": [ ... ] } HOME layout Horizontal Section Vertical Section Input Slack API is stateless. Every request is isolated, so inputs are critical for maintaining interaction context.\nEven if the server disconnects, the state can be restored based on input fields.\nRandom Coffee Chat example Improvements Use Slack DataStore for stateful user data with TTLs Integrate HR info (rank/age/role) to personalize matches Improve UI for clarity and friendliness Add CI/CD and infra for production usage Final Thoughts As a developer, I resonate with the Ubuntu philosophy:\n“I am because we are.”\nFostering collaboration is just as important as individual contribution.\nThat’s why I built CoffeePal ☕\nIf you hit technical roadblocks or need an ice-breaker for teamwork, consider building your own Slack bot!\n","wordCount":"783","inLanguage":"en","image":"https://dingyu.dev/en/posts/coffee-pal/img/slack.png","datePublished":"2024-10-26T00:00:00Z","dateModified":"2024-10-26T00:00:00Z","author":{"@type":"Person","name":"dingyu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://dingyu.dev/en/posts/coffee-pal/"},"publisher":{"@type":"Organization","name":"Ding's Coding Forge","logo":{"@type":"ImageObject","url":"https://dingyu.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://dingyu.dev/en/ accesskey=h title="Ding's Coding Forge (Alt + H)"><img src=https://dingyu.dev/apple-touch-icon.png alt aria-label=logo height=35>Ding's Coding Forge</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://dingyu.dev/ title=한국어 aria-label=한국어>Ko</a></li></ul></div></div><ul id=menu><li><a href=https://dingyu.dev/en/about/ title=About><span>About</span></a></li><li><a href=https://dingyu.dev/en/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://dingyu.dev/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://dingyu.dev/en/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://dingyu.dev/en/search/ title=🔍><span>🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://dingyu.dev/en/>Home</a>&nbsp;»&nbsp;<a href=https://dingyu.dev/en/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[DX] Building a Slack Bot for Internal Coffee Chats</h1><div class=post-description>Developers often work alone, deeply diving into specific techniques. However, as members of a company, we need a space to discuss and brainstorm together. Inspired by the spirit of Ubuntu, I created my own Slack app Slack Bolt Coffee Chat, Coffee Pal</div><div class=post-meta><span title='2024-10-26 00:00:00 +0000 UTC'>October 26, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;783 words&nbsp;·&nbsp;dingyu&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://dingyu.dev/posts/coffee-pal/>Ko</a></li></ul>&nbsp;|&nbsp;<a href=https://github.com/dings-things/blog/tree/main/content/posts/coffee-pal/index.en.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager src=https://dingyu.dev/img/slack.png alt></figure><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#purpose aria-label=Purpose>Purpose</a></li><li><a href=#before-development aria-label="Before Development">Before Development</a></li><li><a href=#requirements aria-label=Requirements>Requirements</a></li><li><a href=#implementation aria-label=Implementation>Implementation</a><ul><li><a href=#using-lambda aria-label="Using Lambda">Using Lambda</a><ul><li><a href=#step-1-create-slack-app aria-label="Step 1: Create Slack App">Step 1: Create Slack App</a></li><li><a href=#step-2-click-from-scratch aria-label="Step 2: Click From scratch">Step 2: Click <code>From scratch</code></a></li><li><a href=#step-3-choose-workspace-and-name aria-label="Step 3: Choose workspace and name">Step 3: Choose workspace and name</a></li><li><a href=#step-4-set-bot-for-user-interaction aria-label="Step 4: Set bot for user interaction">Step 4: Set bot for user interaction</a></li><li><a href=#step-5-enable-events aria-label="Step 5: Enable events">Step 5: Enable events</a></li><li><a href=#lambda-step-1-go-to-lambda-console aria-label="Lambda Step 1: Go to Lambda Console">Lambda Step 1: Go to <a href="https://ap-northeast-2.console.aws.amazon.com/lambda/home?region=ap-northeast-2#/begin">Lambda Console</a></a></li><li><a href=#lambda-step-2-configure-function-runtime-architecture aria-label="Lambda Step 2: Configure function, runtime, architecture">Lambda Step 2: Configure function, runtime, architecture</a></li><li><a href=#lambda-step-3-set-up-api-gateway aria-label="Lambda Step 3: Set up API Gateway">Lambda Step 3: Set up API Gateway</a></li></ul></li><li><a href=#socket-mode-configuration aria-label="Socket Mode Configuration">Socket Mode Configuration</a><ul><li><a href=#step-1-generate-app-level-token aria-label="Step 1: Generate App-Level Token">Step 1: Generate App-Level Token</a></li><li><a href=#step-2-set-token-scope aria-label="Step 2: Set Token Scope">Step 2: Set Token Scope</a></li></ul></li><li><a href=#development aria-label=Development>Development</a><ul><li><a href=#slack-bolt aria-label="Slack Bolt">Slack Bolt</a><ul><li><a href=#without-bolt aria-label="Without Bolt:">Without Bolt:</a></li><li><a href=#with-bolt aria-label="With Bolt:">With Bolt:</a></li></ul></li><li><a href=#block-kit aria-label="Block Kit">Block Kit</a><ul><li><a href=#home-layout aria-label="HOME layout">HOME layout</a></li><li><a href=#horizontal-section aria-label="Horizontal Section">Horizontal Section</a></li><li><a href=#vertical-section aria-label="Vertical Section">Vertical Section</a></li></ul></li><li><a href=#input aria-label=Input>Input</a><ul><li><a href=#random-coffee-chat-example aria-label="Random Coffee Chat example">Random Coffee Chat example</a></li></ul></li></ul></li><li><a href=#improvements aria-label=Improvements>Improvements</a></li><li><a href=#final-thoughts aria-label="Final Thoughts">Final Thoughts</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><blockquote><p>Source Code: <a href=https://github.com/dings-things/coffee_pal>https://github.com/dings-things/coffee_pal</a></p></blockquote><h1 id=purpose>Purpose<a hidden class=anchor aria-hidden=true href=#purpose>#</a></h1><hr><p>Great cultures make great organizations — not just getting things done, but doing them <em>well</em>. Good culture enhances productivity and quality alike.</p><p>I created “CoffeePal” with the idea of helping people stuck on problems or simply wanting a quick small talk boost. The name reflects its purpose: your “coffee pal” during the workday.</p><h1 id=before-development>Before Development<a hidden class=anchor aria-hidden=true href=#before-development>#</a></h1><hr><p>The app needed to be easy and fast, seamlessly matching users via our internal Slack tool.</p><p>To understand the interaction flow, I started with <a href=https://slack.com/intl/en-kr/features/workflow-automation>Slack Workflow</a>.</p><hr><ol><li><p><strong>Create a Trigger Point</strong><br>For testing, I used a <code>:coffee:</code> emoji reaction to initiate the workflow.</p></li><li><p><strong>Activate Workflow</strong><br>A message is sent to the reacting user to confirm whether they want to start a coffee chat.</p></li><li><p><strong>Collect User Information via Form</strong><br>For personalization, users can optionally input their MBTI and birthday.</p></li><li><p><strong>Set Target, Time, and Topic</strong><br>Define the coffee partner, schedule, and discussion topic ahead of time.</p></li><li><p><strong>Send Invitation Message to Partner</strong><br>Using the collected data, send an invitation message to the designated partner.</p></li></ol><p><img loading=lazy src=/posts/coffee-pal/image.png></p><p><img loading=lazy src=/posts/coffee-pal/image-1.png></p><p>I used Slack Workflow for the first time and found the UI clean and intuitive.</p><p>However, it felt more like a one-way communication than true <em>interaction</em>. So, I decided to expand it into a full Slack app.</p><p>It felt like being force-fed food I didn’t want&mldr;</p><p><img loading=lazy src=/posts/coffee-pal/image-2.png></p><h1 id=requirements>Requirements<a hidden class=anchor aria-hidden=true href=#requirements>#</a></h1><hr><ol><li><p>Match users based on pre-saved profile data</p><ul><li>Trigger matching after personal data is submitted</li></ul></li><li><p>Secure compute resources to handle app interactions</p><ul><li><input checked disabled type=checkbox> Internal Server<ul><li>Firewall complexity</li><li>Fast response via socket communication</li></ul></li><li><input disabled type=checkbox> AWS Lambda<ul><li>Free under Free Tier</li><li>Serverless</li><li>Can connect with API Gateway</li><li>Consider future cost after Free Tier</li></ul></li></ul></li><li><p>Intuitive UI for users at a glance</p><ul><li>Use <a href=https://app.slack.com/block-kit-builder>Slack Block Kit</a></li></ul></li></ol><h1 id=implementation>Implementation<a hidden class=anchor aria-hidden=true href=#implementation>#</a></h1><hr><h2 id=using-lambda>Using Lambda<a hidden class=anchor aria-hidden=true href=#using-lambda>#</a></h2><ul><li>Create Slack App</li><li>Set up Lambda</li><li>Configure Socket Mode</li></ul><h3 id=step-1-create-slack-app>Step 1: Create Slack App<a hidden class=anchor aria-hidden=true href=#step-1-create-slack-app>#</a></h3><p>Go to <a href=https://api.slack.com/apps>Slack API</a> and create a new app<br><img loading=lazy src=/posts/coffee-pal/image-3.png></p><h3 id=step-2-click-from-scratch>Step 2: Click <code>From scratch</code><a hidden class=anchor aria-hidden=true href=#step-2-click-from-scratch>#</a></h3><p><img loading=lazy src=/posts/coffee-pal/image-4.png></p><h3 id=step-3-choose-workspace-and-name>Step 3: Choose workspace and name<a hidden class=anchor aria-hidden=true href=#step-3-choose-workspace-and-name>#</a></h3><p><img loading=lazy src=/posts/coffee-pal/image-5.png></p><h3 id=step-4-set-bot-for-user-interaction>Step 4: Set bot for user interaction<a hidden class=anchor aria-hidden=true href=#step-4-set-bot-for-user-interaction>#</a></h3><p><img loading=lazy src=/posts/coffee-pal/image-6.png></p><h3 id=step-5-enable-events>Step 5: Enable events<a hidden class=anchor aria-hidden=true href=#step-5-enable-events>#</a></h3><p><img loading=lazy src=/posts/coffee-pal/image-7.png></p><h3 id=lambda-step-1-go-to-lambda-console>Lambda Step 1: Go to <a href="https://ap-northeast-2.console.aws.amazon.com/lambda/home?region=ap-northeast-2#/begin">Lambda Console</a><a hidden class=anchor aria-hidden=true href=#lambda-step-1-go-to-lambda-console>#</a></h3><p><img loading=lazy src=/posts/coffee-pal/image-8.png></p><h3 id=lambda-step-2-configure-function-runtime-architecture>Lambda Step 2: Configure function, runtime, architecture<a hidden class=anchor aria-hidden=true href=#lambda-step-2-configure-function-runtime-architecture>#</a></h3><p><img loading=lazy src=/posts/coffee-pal/image-9.png></p><h3 id=lambda-step-3-set-up-api-gateway>Lambda Step 3: Set up API Gateway<a hidden class=anchor aria-hidden=true href=#lambda-step-3-set-up-api-gateway>#</a></h3><p>API Gateway routes HTTP requests to Lambda — essential to integrate Slack Events API with Lambda.<br><img loading=lazy src=/posts/coffee-pal/image-10.png></p><p>But then I asked myself&mldr; If we already have a server, why use Lambda? Wouldn’t <em>not</em> using it be wasteful?</p><p>So I decided to use our spare dev server and implement it via socket mode.</p><h2 id=socket-mode-configuration>Socket Mode Configuration<a hidden class=anchor aria-hidden=true href=#socket-mode-configuration>#</a></h2><blockquote><p><strong>What is Socket Mode?</strong><br>Instead of sending payloads to public HTTP endpoints, Slack uses a WebSocket connection to deliver app interactions and events.<br><img loading=lazy src=https://velog.velcdn.com/images/wjddn3711/post/642277c3-713d-427d-9bad-79010dff6847/image.png></p></blockquote><p>Avoiding public endpoints means better security, and you don&rsquo;t need to subscribe to each event individually.</p><h3 id=step-1-generate-app-level-token>Step 1: Generate App-Level Token<a hidden class=anchor aria-hidden=true href=#step-1-generate-app-level-token>#</a></h3><p>Grant permissions to a global token for Slack app control inside the server.<br><img loading=lazy src=https://velog.velcdn.com/images/wjddn3711/post/bf79d0d7-806b-4b11-8b9c-76c3f5874c98/image.png></p><h3 id=step-2-set-token-scope>Step 2: Set Token Scope<a hidden class=anchor aria-hidden=true href=#step-2-set-token-scope>#</a></h3><p><img loading=lazy src=https://velog.velcdn.com/images/wjddn3711/post/a561cd66-446b-4f3b-8f8b-e189e9cedbd0/image.png></p><ul><li><code>channels:read</code>: Get user info from channels</li><li><code>chat:write</code>: Post messages to channels</li><li><code>chat:write.public</code>: Write to channels even if not invited</li><li><code>groups:read</code>: Access private channel info</li><li><code>groups:write</code>: Write in private channels</li><li><code>im:write</code>: Send DMs</li><li><code>mpim:write</code>: Send group DMs</li><li><code>reminders:write</code>: Set reminders</li></ul><h2 id=development>Development<a hidden class=anchor aria-hidden=true href=#development>#</a></h2><h3 id=slack-bolt>Slack Bolt<a hidden class=anchor aria-hidden=true href=#slack-bolt>#</a></h3><blockquote><p>A framework for building Slack apps, supporting languages like Node.js, Python, and JavaScript.</p></blockquote><p>While you might consider skipping it… using Bolt avoids a lot of redundant work. Skipping it results in slower development and difficult maintenance.</p><h4 id=without-bolt>Without Bolt:<a hidden class=anchor aria-hidden=true href=#without-bolt>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>slack_sdk</span> <span class=kn>import</span> <span class=n>WebClient</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>slack_sdk.errors</span> <span class=kn>import</span> <span class=n>SlackApiError</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span><span class=o>,</span> <span class=nn>json</span><span class=o>,</span> <span class=nn>base64</span><span class=o>,</span> <span class=nn>urllib.parse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>lambda_handler</span><span class=p>(</span><span class=n>event</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>bot_token</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s1>&#39;BOT_KEY&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>client</span> <span class=o>=</span> <span class=n>WebClient</span><span class=p>(</span><span class=n>token</span><span class=o>=</span><span class=n>bot_token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>event</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;isBase64Encoded&#39;</span><span class=p>,</span> <span class=kc>False</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>decoded_body</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;body&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>event_body</span> <span class=o>=</span> <span class=n>urllib</span><span class=o>.</span><span class=n>parse</span><span class=o>.</span><span class=n>unquote_plus</span><span class=p>(</span><span class=n>decoded_body</span><span class=p>)[</span><span class=mi>8</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>event_body</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;body&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>event_data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>event_body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span> <span class=s1>&#39;statusCode&#39;</span><span class=p>:</span> <span class=mi>400</span><span class=p>,</span> <span class=s1>&#39;body&#39;</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span><span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid request&#39;</span><span class=p>})</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>event_type</span> <span class=o>=</span> <span class=n>event_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;event&#39;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;type&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># handle event_type...</span>
</span></span></code></pre></div><h4 id=with-bolt>With Bolt:<a hidden class=anchor aria-hidden=true href=#with-bolt>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>App</span><span class=p>(</span><span class=n>token</span><span class=o>=</span><span class=n>settings</span><span class=o>.</span><span class=n>SLACK_BOT_TOKEN</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.event</span><span class=p>(</span><span class=s2>&#34;app_home_opened&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>handle_home</span><span class=p>(</span><span class=n>event</span><span class=p>,</span> <span class=n>client</span><span class=p>:</span> <span class=n>WebClient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.action</span><span class=p>(</span><span class=s2>&#34;suggest_coffee_chat_button&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>handle_chat_button</span><span class=p>(</span><span class=n>ack</span><span class=p>,</span> <span class=n>body</span><span class=p>,</span> <span class=n>client</span><span class=p>:</span> <span class=n>WebClient</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span></code></pre></div><p>Bolt simplifies:</p><ul><li>Auth</li><li>Routing by event/action/view</li><li>Middleware chaining</li></ul><h3 id=block-kit>Block Kit<a hidden class=anchor aria-hidden=true href=#block-kit>#</a></h3><p>Block Kit is at the heart of Slack app UI design.</p><p>Each visual unit is a &ldquo;block&rdquo;. You compose a full view by stacking them.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>HOME_VIEW</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;home&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;blocks&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=home-layout>HOME layout<a hidden class=anchor aria-hidden=true href=#home-layout>#</a></h4><p><img loading=lazy src=/posts/coffee-pal/image-12.png></p><h4 id=horizontal-section>Horizontal Section<a hidden class=anchor aria-hidden=true href=#horizontal-section>#</a></h4><p><img loading=lazy src=/posts/coffee-pal/image-13.png></p><h4 id=vertical-section>Vertical Section<a hidden class=anchor aria-hidden=true href=#vertical-section>#</a></h4><p><img loading=lazy src=/posts/coffee-pal/image-14.png></p><h3 id=input>Input<a hidden class=anchor aria-hidden=true href=#input>#</a></h3><p>Slack API is stateless. Every request is isolated, so inputs are critical for maintaining interaction context.</p><p><img loading=lazy src=/posts/coffee-pal/image-15.png>
<img loading=lazy src=/posts/coffee-pal/image-16.png></p><p>Even if the server disconnects, the state can be restored based on input fields.</p><h4 id=random-coffee-chat-example>Random Coffee Chat example<a hidden class=anchor aria-hidden=true href=#random-coffee-chat-example>#</a></h4><p><img loading=lazy src=/posts/coffee-pal/image-17.png></p><hr><h2 id=improvements>Improvements<a hidden class=anchor aria-hidden=true href=#improvements>#</a></h2><ul><li>Use Slack DataStore for stateful user data with TTLs</li><li>Integrate HR info (rank/age/role) to personalize matches</li><li>Improve UI for clarity and friendliness</li><li>Add CI/CD and infra for production usage</li></ul><h2 id=final-thoughts>Final Thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h2><p>As a developer, I resonate with the Ubuntu philosophy:</p><blockquote><p>“I am because we are.”</p></blockquote><p>Fostering collaboration is just as important as individual contribution.</p><p>That’s why I built <strong>CoffeePal</strong> ☕</p><p><img loading=lazy src=/posts/coffee-pal/image-18.png></p><p>If you hit technical roadblocks or need an ice-breaker for teamwork, consider building your own Slack bot!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://dingyu.dev/en/tags/slack-bot/>Slack-Bot</a></li><li><a href=https://dingyu.dev/en/tags/coffee-chat/>Coffee-Chat</a></li></ul><nav class=paginav><a class=prev href=https://dingyu.dev/en/posts/worker-pool-async/><span class=title>« Prev</span><br><span>[Go] Profiling Worker Pool vs. Async Processing</span>
</a><a class=next href=https://dingyu.dev/en/posts/go-pprof-gc/><span class=title>Next »</span><br><span>[Go] Tuning GC with pprof</span></a></nav></footer><div id=giscus_thread><script src=https://giscus.app/client.js data-repo=dings-things/blog data-repo-id=R_kgDON9IuAw data-category=Announcements data-category-id=DIC_kwDON9IuA84CnTai data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko data-loading=lazy crossorigin=anonymous async></script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://dingyu.dev/en/>Ding's Coding Forge</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
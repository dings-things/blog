<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[Go] Gophercon 2024 - Building Minimalistic Backend Microservice in Go | Ding's Coding Forge</title>
<meta name=keywords content="go,project guide,good practice"><meta name=description content="Say goodbye to unnecessary frameworks‚Äîit's time to go back to the basics. This post demonstrates how to build minimalistic backend applications using pure vanilla Go."><meta name=author content="dingyu"><link rel=canonical href=https://dingyu.dev/en/posts/gopher-con-2024-minimalistic-go/><meta name=google-site-verification content="8XY1hI6NVxQIrN7bQbnX-9TG9HHFw5HOQmlb6vcsFdQ"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.ba0de23ad40e17ca82720b577f8ae6ec11a26fb07407316cff70888e344ad129.css integrity="sha256-ug3iOtQOF8qCcgtXf4rm7BGib7B0BzFs/3CIjjRK0Sk=" rel="preload stylesheet" as=style><link rel=icon href=https://dingyu.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://dingyu.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://dingyu.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://dingyu.dev/apple-touch-icon.png><link rel=mask-icon href=https://dingyu.dev/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=ko href=https://dingyu.dev/posts/gopher-con-2024-minimalistic-go/><link rel=alternate hreflang=en href=https://dingyu.dev/en/posts/gopher-con-2024-minimalistic-go/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XH8830R9KK"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XH8830R9KK")}</script><meta property="og:url" content="https://dingyu.dev/en/posts/gopher-con-2024-minimalistic-go/"><meta property="og:site_name" content="Ding's Coding Forge"><meta property="og:title" content="[Go] Gophercon 2024 - Building Minimalistic Backend Microservice in Go"><meta property="og:description" content="Say goodbye to unnecessary frameworks‚Äîit's time to go back to the basics. This post demonstrates how to build minimalistic backend applications using pure vanilla Go."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-05T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-05T00:00:00+00:00"><meta property="article:tag" content="Go"><meta property="article:tag" content="Project Guide"><meta property="article:tag" content="Good Practice"><meta property="og:image" content="https://dingyu.dev/en/posts/gopher-con-2024-minimalistic-go/img/go-thumbnail.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dingyu.dev/en/posts/gopher-con-2024-minimalistic-go/img/go-thumbnail.png"><meta name=twitter:title content="[Go] Gophercon 2024 - Building Minimalistic Backend Microservice in Go"><meta name=twitter:description content="Say goodbye to unnecessary frameworks‚Äîit's time to go back to the basics. This post demonstrates how to build minimalistic backend applications using pure vanilla Go."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://dingyu.dev/en/posts/"},{"@type":"ListItem","position":2,"name":"[Go] Gophercon 2024 - Building Minimalistic Backend Microservice in Go","item":"https://dingyu.dev/en/posts/gopher-con-2024-minimalistic-go/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[Go] Gophercon 2024 - Building Minimalistic Backend Microservice in Go","name":"[Go] Gophercon 2024 - Building Minimalistic Backend Microservice in Go","description":"Say goodbye to unnecessary frameworks‚Äîit's time to go back to the basics. This post demonstrates how to build minimalistic backend applications using pure vanilla Go.","keywords":["go","project guide","good practice"],"articleBody":"MSA Requirements for a Go App Configuration management, graceful shutdown Testable code API specifications Logging Profiling, error monitoring, metrics, API tracing Tiny Main Abstraction Instead of using separate .env files, environment variables are read directly from the OS. A question raised: isn‚Äôt setting every OS argument as a flag wasteful? Graceful Shutdown Testable Code The speaker waits for the server startup with long polling before running tests‚Äînot the cleanest method. Since the speaker is focused on vanilla Go, it seems they deliberately chose not to use the httptest package. Health Check Version is set using ldflags, which could be automatically tagged during release. Storing server start time is preferred over tracking total uptime. Documentation is a Must As Gophers say, ‚ÄúGoDoc isn‚Äôt optional‚Äîit‚Äôs essential.‚Äù\nWhile the speaker didn‚Äôt use godoc, they emphasized exposing OpenAPI specs. go:embed embeds OpenAPI files into the binary at build time. Build fails if the file is missing. Swagger endpoints expose the embedded documentation. Maintaining Swagger alongside code updates may not be sustainable. Using swaggo might be more intuitive.\nLogging is a Must JSON logging with slog is adopted‚Äîa must for modern apps.\nFollowing the 12-factor app philosophy, logs are written to stdout. This reduces File I/O costs.\nFluentbit handles post-processing with multiple outputs:\nSentry: Error tracking Jaeger: API tracing Elasticsearch: Log storage for Kibana Decorate Decorates the response writer to track HTTP status codes and byte sizes. Reflections This approach contrasts with rigid project structures. The minimal Go style without strict clean architecture was convincing. Some trade-offs are inevitable. Even when using established frameworks, clean and concise code is still achievable. Fluentbit should be adopted company-wide to reduce log coupling in the app. Company-wide tracing adoption (e.g., Jaeger, OpenTelemetry) is a must, potentially mandated by CTOs. Applying to Production // HealthHandler : Server health status handler type HealthHandler struct { version string startTime time.Time } // NewHealthHandler : Creates a new HealthHandler func NewHealthHandler(version string) HealthHandler { return HealthHandler{ version: version, startTime: time.Now(), } } // Check : Returns server status and build metadata func (h HealthHandler) Check(ctx *gin.Context) { type responseBody struct { Version string `json:\"version\"` Uptime string `json:\"up_time\"` LastCommitHash string `json:\"last_commit_hash\"` LastCommitTime time.Time `json:\"last_commit_time\"` DirtyBuild bool `json:\"dirty_build\"` } var ( lastCommitHash string lastCommitTime time.Time dirtyBuild bool ) { buildInfo, _ := debug.ReadBuildInfo() for _, kv := range buildInfo.Settings { if kv.Value == \"\" { continue } switch kv.Key { case \"vcs.revision\": lastCommitHash = kv.Value case \"vcs.time\": lastCommitTime, _ = time.Parse(time.RFC3339, kv.Value) case \"vcs.modified\": dirtyBuild = kv.Value == \"true\" } } } up := time.Now() ctx.JSON(http.StatusOK, responseBody{ Version: h.version, Uptime: up.Sub(h.startTime).String(), LastCommitHash: lastCommitHash, LastCommitTime: lastCommitTime, DirtyBuild: dirtyBuild, }) } ","wordCount":"435","inLanguage":"en","image":"https://dingyu.dev/en/posts/gopher-con-2024-minimalistic-go/img/go-thumbnail.png","datePublished":"2024-11-05T00:00:00Z","dateModified":"2024-11-05T00:00:00Z","author":{"@type":"Person","name":"dingyu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://dingyu.dev/en/posts/gopher-con-2024-minimalistic-go/"},"publisher":{"@type":"Organization","name":"Ding's Coding Forge","logo":{"@type":"ImageObject","url":"https://dingyu.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://dingyu.dev/en/ accesskey=h title="Ding's Coding Forge (Alt + H)"><img src=https://dingyu.dev/apple-touch-icon.png alt aria-label=logo height=35>Ding's Coding Forge</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://dingyu.dev/ title=ÌïúÍµ≠Ïñ¥ aria-label=ÌïúÍµ≠Ïñ¥>Ko</a></li></ul></div></div><ul id=menu><li><a href=https://dingyu.dev/en/about/ title=About><span>About</span></a></li><li><a href=https://dingyu.dev/en/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://dingyu.dev/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://dingyu.dev/en/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://dingyu.dev/en/search/ title=üîç><span>üîç</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://dingyu.dev/en/>Home</a>&nbsp;¬ª&nbsp;<a href=https://dingyu.dev/en/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[Go] Gophercon 2024 - Building Minimalistic Backend Microservice in Go</h1><div class=post-description>Say goodbye to unnecessary frameworks‚Äîit's time to go back to the basics. This post demonstrates how to build minimalistic backend applications using pure vanilla Go.</div><div class=post-meta><span title='2024-11-05 00:00:00 +0000 UTC'>November 5, 2024</span>&nbsp;¬∑&nbsp;3 min&nbsp;¬∑&nbsp;435 words&nbsp;¬∑&nbsp;dingyu&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://dingyu.dev/posts/gopher-con-2024-minimalistic-go/>Ko</a></li></ul>&nbsp;|&nbsp;<a href=https://github.com/dings-things/blog/tree/main/content/posts/gopher-con-2024-minimalistic-go/index.en.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=eager src=https://dingyu.dev/img/go-thumbnail.png alt></figure><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#msa-requirements-for-a-go-app aria-label="MSA Requirements for a Go App">MSA Requirements for a Go App</a></li><li><a href=#tiny-main-abstraction aria-label="Tiny Main Abstraction">Tiny Main Abstraction</a></li><li><a href=#graceful-shutdown aria-label="Graceful Shutdown">Graceful Shutdown</a></li><li><a href=#testable-code aria-label="Testable Code">Testable Code</a></li><li><a href=#health-check aria-label="Health Check">Health Check</a></li><li><a href=#documentation-is-a-must aria-label="Documentation is a Must">Documentation is a Must</a></li><li><a href=#logging-is-a-must aria-label="Logging is a Must">Logging is a Must</a></li><li><a href=#decorate aria-label=Decorate>Decorate</a></li><li><a href=#reflections aria-label=Reflections>Reflections</a></li><li><a href=#applying-to-production aria-label="Applying to Production">Applying to Production</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h3 id=msa-requirements-for-a-go-app>MSA Requirements for a Go App<a hidden class=anchor aria-hidden=true href=#msa-requirements-for-a-go-app>#</a></h3><ul><li>Configuration management, graceful shutdown</li><li>Testable code</li><li>API specifications</li><li>Logging</li><li>Profiling, error monitoring, metrics, API tracing</li></ul><hr><h3 id=tiny-main-abstraction>Tiny Main Abstraction<a hidden class=anchor aria-hidden=true href=#tiny-main-abstraction>#</a></h3><p><img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image.png></p><ul><li>Instead of using separate .env files, environment variables are read directly from the OS.</li><li>A question raised: isn&rsquo;t setting every OS argument as a flag wasteful?</li></ul><hr><h3 id=graceful-shutdown>Graceful Shutdown<a hidden class=anchor aria-hidden=true href=#graceful-shutdown>#</a></h3><p><img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-1.png></p><hr><h3 id=testable-code>Testable Code<a hidden class=anchor aria-hidden=true href=#testable-code>#</a></h3><p><img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-2.png>
<img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-3.png></p><ul><li>The speaker waits for the server startup with long polling before running tests‚Äînot the cleanest method.</li><li>Since the speaker is focused on vanilla Go, it seems they deliberately chose not to use the <code>httptest</code> package.</li></ul><hr><h3 id=health-check>Health Check<a hidden class=anchor aria-hidden=true href=#health-check>#</a></h3><p><img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-4.png>
<img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-5.png>
<img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-6.png>
<img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-7.png></p><ul><li>Version is set using <code>ldflags</code>, which could be automatically tagged during release.</li><li>Storing server <strong>start time</strong> is preferred over tracking total <strong>uptime</strong>.
<img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-8.png></li></ul><hr><h3 id=documentation-is-a-must>Documentation is a Must<a hidden class=anchor aria-hidden=true href=#documentation-is-a-must>#</a></h3><blockquote><p>As Gophers say, &ldquo;GoDoc isn&rsquo;t optional‚Äîit‚Äôs essential.&rdquo;</p></blockquote><p><img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-9.png></p><ul><li>While the speaker didn&rsquo;t use godoc, they emphasized exposing OpenAPI specs.</li><li><code>go:embed</code> embeds OpenAPI files into the binary at build time. Build fails if the file is missing.</li><li>Swagger endpoints expose the embedded documentation.</li></ul><blockquote><p>Maintaining Swagger alongside code updates may not be sustainable. Using <code>swaggo</code> might be more intuitive.</p></blockquote><hr><h3 id=logging-is-a-must>Logging is a Must<a hidden class=anchor aria-hidden=true href=#logging-is-a-must>#</a></h3><p><img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-10.png></p><ul><li><p>JSON logging with <code>slog</code> is adopted‚Äîa must for modern apps.</p></li><li><p>Following the 12-factor app philosophy, logs are written to stdout. This reduces File I/O costs.</p></li><li><p>Fluentbit handles post-processing with multiple outputs:</p><ul><li>Sentry: Error tracking</li><li>Jaeger: API tracing</li><li>Elasticsearch: Log storage for Kibana</li></ul></li></ul><hr><h3 id=decorate>Decorate<a hidden class=anchor aria-hidden=true href=#decorate>#</a></h3><p><img loading=lazy src=/posts/gopher-con-2024-minimalistic-go/image-11.png></p><ul><li>Decorates the response writer to track HTTP status codes and byte sizes.</li></ul><hr><h3 id=reflections>Reflections<a hidden class=anchor aria-hidden=true href=#reflections>#</a></h3><ul><li>This approach contrasts with rigid project structures. The minimal Go style without strict clean architecture was convincing.</li><li>Some trade-offs are inevitable. Even when using established frameworks, clean and concise code is still achievable.</li><li>Fluentbit should be adopted company-wide to reduce log coupling in the app.</li><li>Company-wide tracing adoption (e.g., Jaeger, OpenTelemetry) is a must, potentially mandated by CTOs.</li></ul><hr><h3 id=applying-to-production>Applying to Production<a hidden class=anchor aria-hidden=true href=#applying-to-production>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// HealthHandler : Server health status handler</span>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>HealthHandler</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>version</span>   <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=nx>startTime</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// NewHealthHandler : Creates a new HealthHandler</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewHealthHandler</span><span class=p>(</span><span class=nx>version</span> <span class=kt>string</span><span class=p>)</span> <span class=nx>HealthHandler</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>HealthHandler</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>version</span><span class=p>:</span>   <span class=nx>version</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>startTime</span><span class=p>:</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Check : Returns server status and build metadata</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>h</span> <span class=nx>HealthHandler</span><span class=p>)</span> <span class=nf>Check</span><span class=p>(</span><span class=nx>ctx</span> <span class=o>*</span><span class=nx>gin</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>type</span> <span class=nx>responseBody</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>Version</span>        <span class=kt>string</span>    <span class=s>`json:&#34;version&#34;`</span>
</span></span><span class=line><span class=cl>		<span class=nx>Uptime</span>         <span class=kt>string</span>    <span class=s>`json:&#34;up_time&#34;`</span>
</span></span><span class=line><span class=cl>		<span class=nx>LastCommitHash</span> <span class=kt>string</span>    <span class=s>`json:&#34;last_commit_hash&#34;`</span>
</span></span><span class=line><span class=cl>		<span class=nx>LastCommitTime</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span> <span class=s>`json:&#34;last_commit_time&#34;`</span>
</span></span><span class=line><span class=cl>		<span class=nx>DirtyBuild</span>     <span class=kt>bool</span>      <span class=s>`json:&#34;dirty_build&#34;`</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=nx>lastCommitHash</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>		<span class=nx>lastCommitTime</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
</span></span><span class=line><span class=cl>		<span class=nx>dirtyBuild</span>     <span class=kt>bool</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>buildInfo</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>debug</span><span class=p>.</span><span class=nf>ReadBuildInfo</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>kv</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>buildInfo</span><span class=p>.</span><span class=nx>Settings</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=nx>kv</span><span class=p>.</span><span class=nx>Value</span> <span class=o>==</span> <span class=s>&#34;&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>continue</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=k>switch</span> <span class=nx>kv</span><span class=p>.</span><span class=nx>Key</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>case</span> <span class=s>&#34;vcs.revision&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>				<span class=nx>lastCommitHash</span> <span class=p>=</span> <span class=nx>kv</span><span class=p>.</span><span class=nx>Value</span>
</span></span><span class=line><span class=cl>			<span class=k>case</span> <span class=s>&#34;vcs.time&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>				<span class=nx>lastCommitTime</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Parse</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>RFC3339</span><span class=p>,</span> <span class=nx>kv</span><span class=p>.</span><span class=nx>Value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=k>case</span> <span class=s>&#34;vcs.modified&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>				<span class=nx>dirtyBuild</span> <span class=p>=</span> <span class=nx>kv</span><span class=p>.</span><span class=nx>Value</span> <span class=o>==</span> <span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>up</span> <span class=o>:=</span> <span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nf>JSON</span><span class=p>(</span><span class=nx>http</span><span class=p>.</span><span class=nx>StatusOK</span><span class=p>,</span> <span class=nx>responseBody</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>Version</span><span class=p>:</span>        <span class=nx>h</span><span class=p>.</span><span class=nx>version</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>Uptime</span><span class=p>:</span>         <span class=nx>up</span><span class=p>.</span><span class=nf>Sub</span><span class=p>(</span><span class=nx>h</span><span class=p>.</span><span class=nx>startTime</span><span class=p>).</span><span class=nf>String</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>		<span class=nx>LastCommitHash</span><span class=p>:</span> <span class=nx>lastCommitHash</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>LastCommitTime</span><span class=p>:</span> <span class=nx>lastCommitTime</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>DirtyBuild</span><span class=p>:</span>     <span class=nx>dirtyBuild</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://dingyu.dev/en/tags/go/>Go</a></li><li><a href=https://dingyu.dev/en/tags/project-guide/>Project Guide</a></li><li><a href=https://dingyu.dev/en/tags/good-practice/>Good Practice</a></li></ul><nav class=paginav><a class=prev href=https://dingyu.dev/en/posts/flink-dynamic-job/><span class=title>¬´ Prev</span><br><span>[EDA] Flink Dynamic Job Case Study</span>
</a><a class=next href=https://dingyu.dev/en/posts/gopher-con-2024-go-project-guide/><span class=title>Next ¬ª</span><br><span>[Go] Gophercon 2024 - Go Project Guide from A to Z</span></a></nav></footer><div id=giscus_thread><script src=https://giscus.app/client.js data-repo=dings-things/blog data-repo-id=R_kgDON9IuAw data-category=Announcements data-category-id=DIC_kwDON9IuA84CnTai data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=ko data-loading=lazy crossorigin=anonymous async></script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://dingyu.dev/en/>Ding's Coding Forge</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>